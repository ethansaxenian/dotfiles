#!/usr/bin/env zsh

# open a new iterm2 window at the current directory

if [[ $(uname -s) != "Darwin" ]]; then
  return
fi

dir="$PWD"

if test -n "$1"; then
  dir="${PWD}/${1}"
fi

# handle absolute path argument
if [[ "$1" =~ "^/.*" ]]; then
  dir="$1"
fi

osascript -e "
  tell application \"iTerm2\"
    create window with default profile
    tell current session of current window
      write text \"cd $dir\"
    end tell
  end tell
"
